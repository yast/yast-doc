<HTML>
<HEAD>
<TITLE>YaST2: Configuration Modules</TITLE>
</HEAD>
<BODY bgcolor=#ffffff>
<H1>YaST2: Configuration Modules</H1>

Phase I of YaST2 solved the automatic installation problem.<BR>
<P>
In Phase II, <B>automatic configuration</B> is the goal.<BR>
<P>
This includes most built-in hardware (cards) and external devices
(printers, modems, etc.). A list of typical user hardware which needs
configuration is (in descending importance):
<UL>
  <LI>Printer</LI>
  <LI>Soundcard</LI>
  <LI>Network Card</LI>
  <LI>Modem</LI>
  <LI>ISDN Card</LI>
  <LI>TV Cards, Framegrabber</LI>
  <LI>USB Devices</LI>
  <LI>CD-R, CD-RW drives</LI>
  <LI>Backup devices (Tapes)</LI>
  <LI>3D accellarator hard- and software</LI>
</UL>
<P>
Furthermore, system configuration is needed to properly support
linux functions and devices:
<UL>
  <LI>Network config</LI>
  <LI>Internet dialup</LI>
</UL>
<P>
These lists aren't complete yet, the feature list for YaST2 will be
fixed over the next 2 weeks.
<hr>
<H2>Configuration Modules Project Description</H2>
The functional specification and the design of the configuration modules
should be mostly independent of the current YaST2 implementation.<BR>
<H3>Step 1</H3>
The first task is to indentify<BR>
<UL>
<LI>which information is needed for the configuration of X ?</LI>
<P>
<LI>how is this information determined ?<BR>
    can it automatically be derived (hw-probing, scanning files, ...) ?<BR>
    must information be asked from the user ?<BR>
    is a reasonable default available ?<BR>
</LI>
<P>
<LI>which information dependencies and requirements exist ?<BR>
    (is the data consistent ? is it type-correct ? is it reasonable ?)
</LI>
<P>
<LI>how is the information used ?<BR>
    what exactly is done by configuration ?<BR>
    which programs must be started ?<BR>
    which files are affected ?<BR>
</LI>
<P>
<LI>how can the success/failure be determined ?<BR>
    automatically or manually ?<BR>
    (i.e. setting up a modem can be checked by sending AT commands,<BR>
    setting up a printer requires the user to say 'ok, printed page looks good')<BR>
</LI>
</UL>
<P>
<H3>Step 2</H3>
The a modular concept must be established which identifies common and
specialized functionality for all modules.<BR> I.e. The input of network parameters
is mostly the same for ethernet or isdn/ppp networking and should be done
with one dialogue.<P>
Together with the YaST2 team, it should then be decided which modules belong
to the YaST2-core (i.e. hw-probe, calls to system commands, reading/writing
of system-wide configuration files, ...) and which modules are purely configuration
related.
<P>
<H3>Step 3</H3>
The modular concept together with the 'information flow' from step 1
are now used to define user visible dialogues. These dialogues must follow
the principles of ergonomic interfaces. The current YaST2 installer is
an example.<BR>
For each dialogue, a standard and an expert mode must be defined. Both
modes should provide default values, either computed or taken from the
current configuration. The standard mode is for novice user, only a
minimum of questions should be asked. Inconsitent values are forbidden.<BR>
The expert mode lets the user change any value. If wrong or incosistent
data is provided by the user, a warning should appear but the input should
not be rejected.
<P>
One task in step 3 is the prototypical implementation of all dialogue
screens. This includes all messages, pop-up windows, help texts, etc.
<BR>This is the first point in the project where implementation in the
YaST2 environment is needed.
<P>
<H2>Functional specification</h2>
Steps 1 to 3 together define the functional specification which directly
leads to the implementation in the YaST2 framework.
<P>
<H3>Example</H3>
As an example of what is expected from the configuration module specification,
the installation of a printer is described. This example is by no means complete,
but should give you a hint on what is needed.
<P>
Another example is sound card configuration. It should start by identifying
a soundcard (or ask the user) and stop with a confirmative answer from the
user for "Did you hear the sound ?".
<P>
<H4>Printer configuration</H4>
This is purely fictional pseudo-code and not related to YaST2 in any way !<BR>
<PRE>
module printer_configuration {

  list printers_to_be_installed;

  // most newer printer can be identified on the parallel port

  if (hw_probe (parallel_port_existant))
    printers_to_be_installed += hw_probe (printer_attached_to_parallel_port)
  else if (hw_probe (serial_port_existant))
    printers_to_be_installed += hw_probe (printer_attached_to_seriell_port)

  // show user what we found

  if (is_empty (printers_to_be_installed))
    answer = ask_user ("do you want to install a printer")
  else
    answer = ask_user ("The following printer(s) was/were indentified,
		do you want to configure it/them now ?")

  if (answer == no)
    return;

  // nothing probed, let user choose

  if (is_empty (printers_to_be_installed))
    printers_to_be_installed = dialogue ("which printer, where attached, which protocol ?");

  // if remote printer, check if network is installed

  if (printer_on_network)
    check_if_network_is_already_configured();

  // check if needed software is present

  result = check_for_lpd_package ();
  if (result == false)
    install_package (lpd);

  // remind user that somethings happening now

  popup ("ok, configuring printer X, please check if its turned on");

  // try to print a page that satisfies the user

  for (;;) {
     print_a_page ();
     answer = ask_user ("was the page printed correctly ?");
     if (answer == yes)
	break;

     // implement 'printer checklist' from SuSE installation manual here
     // check logfiles, line printer daemon, ask user to check cabling
     // etc, etc.

  }

  return;
}
</PRE>
Common modules needed:<br>
hardware-probe for printer<br>
check for installed software package<br>
install software package<br>
check if device X configured<br>
write /etc/printcap<br>
<BR>
Local modules needed:<BR>
start lpd<br>
evaluate lpd status<br>
print page<br>
<P><HR>
<SMALL>Last change: 30-11-1999 14:50, <A HREF="mailto:kkaempf@suse.de">Klaus Kämpf</A></SMALL><BR>
<SMALL>Copyright &copy; by <A HREF="http://w3.suse.de">SuSE GmbH</A></SMALL>
</BODY>
</HTML>
